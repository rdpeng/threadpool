<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parallel Processing with a Thread Pool • threadpool</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Parallel Processing with a Thread Pool">
<meta property="og:description" content="A parallel programming backend for R using a thread pool model that can be dynamically resized.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">threadpool</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="threadpool" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#threadpool" class="anchor"></a>threadpool</h1></div>
<p>The <code>threadpool</code> package implements a simple parallel programming backend using a thread pool model that can be dynamically resized during operation. The package builds clusters by setting up a queue of input jobs and having the individual cluster nodes retrieve jobs from the queue one at a time. The queue is stored on-disk and nodes communicate with each other via the filesystem.</p>
<p>A few benefits of this model of parallel computing are</p>
<ul>
<li><p><em>Dynamic resource allocation</em>: You can modify the number of resources dedicated to a job as the job is running and as resources become available or unavailable.</p></li>
<li><p><em>Automatic load balancing</em>: Tasks are not prescheduled to specific nodes of the cluster and so long-running jobs do not prevent faster-running jobs from executing.</p></li>
<li><p><em>Fault tolerance and restartability</em>: Tasks can continue executing as nodes come in and out of the cluster. In particular, if the entire cluster goes down, the job can be automatically restarted where it left off.</p></li>
<li><p><em>Seamless switching to parallel mode</em>: It’s easy to start and debug a job in single processor mode and then ramp up to parallel computing without needing to start the job over again.</p></li>
<li><p><em>Overall job resizing</em>: If in the middle of a job run you decide you want to add more tasks, you can simply add them withouth having to start the whole job over again.</p></li>
</ul>
<p>This package will be most useful in situations where the jobs being run</p>
<ul>
<li><p>are embarassingly parallel, and so don’t require complex communication between nodes;</p></li>
<li><p>are relatively long-running, on the order of hours or days;</p></li>
<li><p>are being run on a batch/queued system where the availability of processors varies over time;</p></li>
<li><p>have individual tasks that are heterogeneous in their runtimes.</p></li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install threadpool from GitHub with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("remotes")</span>
remotes::<span class="kw">install_github</span>(<span class="st">"rdpeng/threadpool"</span>)</code></pre></div>
<p>The <code>threadpool</code> package makes use of the <code>thor</code> package by Rich FitzJohn. This package can be installed from GitHub with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">remotes::<span class="kw">install_github</span>(<span class="st">"richfitz/thor"</span>)</code></pre></div>
<p>In addition, you need to install the <code>queue</code> package from GitHub with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">remotes::<span class="kw">install_github</span>(<span class="st">"rdpeng/queue"</span>)</code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example of how you might invoke the <code>threadpool</code> package. The basic approach is to initialize the cluster (which also adds tasks to the cluster), join the cluster, and then run it by starting the execution of jobs. Once the cluster is finished running, you can retrieve the results. Finally, once we are finished we can delete the cluster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(threadpool)

<span class="kw">data</span>(airquality)
x &lt;-<span class="st"> </span><span class="kw">as.list</span>(airquality)

f &lt;-<span class="st"> </span>function(x) {
        <span class="kw">mean</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
}

## Initialize the cluster
cl &lt;-<span class="st"> </span><span class="kw"><a href="reference/cluster_initialize.html">cluster_initialize</a></span>(<span class="st">"my_cluster"</span>, x, f)

## Run jobs
cl &lt;-<span class="st"> </span><span class="kw"><a href="reference/cluster_run.html">cluster_run</a></span>(cl)
<span class="co">#&gt; Starting cluster node: 53994</span>

## Gather the output
r &lt;-<span class="st"> </span><span class="kw"><a href="reference/cluster_reduce.html">cluster_reduce</a></span>(cl)
r[<span class="dv">1</span>:<span class="dv">3</span>]
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 15.80392</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 42.12931</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 77.88235</span>

## Clean up
<span class="kw"><a href="reference/delete_cluster.html">delete_cluster</a></span>(<span class="st">"my_cluster"</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/rdpeng/threadpool/issues">https://​github.com/​rdpeng/​threadpool/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Roger Peng <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Roger Peng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
